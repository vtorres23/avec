/*var  linechart = dc.barChart('#chart-01');
	periodoRingChart   = dc.pieChart("#chart-03"),
	masculinoChart = dc.numberDisplay("#chart-07"),	
	femininoChart = dc.numberDisplay("#chart-08"),	
	cesarioChart = dc.numberDisplay("#chart-09"),	
	

	brancaChart = dc.numberDisplay("#brancaChart"),	
	amarelaChart = dc.numberDisplay("#amarelaChart"),	
	pardaChart = dc.numberDisplay("#pardaChart"),	
	pretaChart = dc.numberDisplay("#pretaChart"),	
	indigenaChart = dc.numberDisplay("#indigenaChart"),	

	chart15 = dc.numberDisplay("#chart15"),	
	chart16 = dc.numberDisplay("#chart16"),	
	chart17 = dc.numberDisplay("#chart17"),	
	chart18 = dc.numberDisplay("#chart18"),	
	chart19 = dc.numberDisplay("#chart19"),	
	chart20 = dc.numberDisplay("#chart20"),	
	chart21 = dc.numberDisplay("#chart21"),	

	chart22 = dc.numberDisplay("#chart22"),	
	chart23 = dc.numberDisplay("#chart23"),	
	chart24 = dc.numberDisplay("#chart24"),	
	chart25 = dc.numberDisplay("#chart25"),	
	chart26 = dc.numberDisplay("#chart26"),	
	
	
	
	*/
	
/*	totalChart = dc.numberDisplay("#chart-06"),		
   

	lineChart1 = dc.compositeChart("#comparativo"),    
	*/
//	var chart01 = dc.geoChoroplethChart("#chart-01");		

    var numberFormat = d3.format(".2f");

    var usChart = dc.geoChoroplethChart("#chart27");
    var industryChart = dc.bubbleChart("#chart28");
    var roundChart = dc.bubbleChart("#chart29");
	
	//var mapa =  document.getElementById('mapa').offsetWidth -100;
	
	/*inicio dos graficos e arquivo de depositos*/
	/*d3.csv("../data/depositos_inpi_2016_atenovembro.csv", function (csv) {
	
	    var data = crossfilter(csv);

        var uf = data.dimension(function (d) {
            return d["uf"];
        });
        var stateRaisedSum = uf.group().reduceSum(function (d) {
            return d["total_geral"];
        });
		
	        d3.json("../data/brazil.json", function (statesJson) {
            chart01.width(mapa)
					 .projection(d3.geo.albers()
						  .center([-85,-8.4])
						  .parallels( [11.5,-38])
						  .scale(mapa*0.7)
						  .rotate([55, -3, -5])
						  .translate([mapa/2 - (mapa-(mapa/11.6)),mapa/2 -(mapa/4.6)]))
                    .height(mapa-300)
                    .dimension(uf)
                    .group(stateRaisedSum)
                    .colors([ "#4e4200", "#625300", "#766300", "#897400", "#9d8400", "#b19500", "#c4a500", "#d8b600"])
                    .colorDomain([0, 	60000])
                    .overlayGeoJson(statesJson.features, "state", function (d) {
                        return d.properties.name;
                    })
                    .title(function (d) {
                        return "UF: " + d.key + "\nTotal de dep√≥sitos: " + numberFormat(d.value ? d.value : 0)
                    });

            dc.renderAll();
        });
	});	*/
	/*fim dos graficos e arquivo de depositos*/
	
	
	var tablewidth =  document.getElementById('bigchart-05').offsetWidth;
	

	var mychart = dc.rowChart("#chart-04");
	d3.csv(inpi_personalidade, function(error, experiments) {

	  var ndx                 = crossfilter(experiments),
		  runDimension        = ndx.dimension(function(d) {return d.origem;}),
		  speedSumGroup       = runDimension.group().reduceSum(function(d) {return +d.total_geral;});

	
	var dataTableOptions = {
				"sWidth": tablewidth*.65,
				"bScrollCollapse": true,
				"bPaginate": true,
				"bJQueryUI": true,
                "lengthMenu": [[6], [7]],
                "retrieve": true,
                columnDefs: [
			        {
						"width": "15%",
                        "orderable": true,
						"orderData": [ 1, 1 ],
                        targets: 0,
                        data: function (d) { return d.origem;}
                    } ,
                    {
						"width": "20%",
                        "orderable": true,
						"orderData": [ 1, 1 ],
                        targets: 1,
                        data: function (d) { return d.personalidade;}
                    } ,
					{
						"width": "20%",
                        "orderable": true,
						"orderData": [ 1, 1 ],
                        targets: 2,
                        data: function (d) { return d.detalhe;}
                    } ,

                    {
						"width": "12.5%",
                        "orderable": false,
                        targets: 3,
                        data: function (d) { return d.patente_invencao + " ("+((d.patente_invencao/d.total_geral)*100).toFixed(2)+"%)" ; }
                    },
                    {
						"width": "12.5%",
                        "orderable": false,
                        targets: 4,
                        data: function (d) { return d.modelo_utilidade + " ("+((d.modelo_utilidade/d.total_geral)*100).toFixed(2)+"%)" }
                    },
                    {
						"width": "12.55%",
                        "orderable": false,
                        targets: 5,
                        data: function (d) { return d.certificado_adicao + " ("+((d.certificado_adicao/d.total_geral)*100).toFixed(2)+"%)" }
                    },
			        {
						"width": "7.5%",
                        "orderable": false,
                        targets: 6,
                        data: function (d) { return d.total_geral; }
                    }
                ]
            };
			

		
		//console.log(dataTableOptions);		
			$("#chart-05").css("width","80%");
            var datatable = $('#chart-05').dataTable(dataTableOptions);
				  				
            function RefreshTable() {
                dc.events.trigger(function () {
                    datatable.api()
                      .clear()					  
                      .rows.add(runDimension.top(12))
                      .draw();
                });
            }
            for (var i = 0; i < dc.chartRegistry.list().length; i++) {
                var chartI = dc.chartRegistry.list()[i];
                chartI.on("filtered", RefreshTable);
            }

            //Jquery DT

            window.filter = function (filters) {
                filters.forEach(function (d, i) { charts[i].filter(d); });
                renderAll();
            };

            window.reset = function (i) {
                charts[i].filter(null);
                renderAll();
            };

			
			
            RefreshTable();			  
			
	var heightTable =  document.getElementById('chart-05_wrapper').offsetHeight;	

		  mychart
			  .width(768)
			  .height(heightTable)
			  .x(d3.scale.ordinal())
			  //.x(d3.scale.linear().domain([6,20]))
			  .elasticX(true)		  
			  .dimension(runDimension)
			  .group(speedSumGroup);
		  mychart.render();
		  
		  
	});

    d3.csv(indice, function (csv) {
        var data = crossfilter(csv);

        var states = data.dimension(function (d) {
            return d["economy"];
        });
        var stateRaisedSum = states.group().reduceSum(function (d) {
            return d["score_global"];
        });
        var rankGlobalSum = states.group().reduceSum(function (d) {
            return d["rank_global"];
        });			
		

        var industries = data.dimension(function (d) {
            return d["economy"];
        });
        var statsByIndustries = industries.group().reduce(
                function (p, v) {
                    p.amountRaised += +v["score_universidade"];
                    p.deals += +v["rank_universidade"];
                    return p;
                },
                function (p, v) {
                    p.amountRaised -= +v["score_universidade"];
                    //if (p.amountRaised < 0.001) p.amountRaised = 0; // do some clean up
                    p.deals -= +v["rank_universidade"];
                    return p;
                },
                function () {
                    return {amountRaised: 0, deals: 0}
                }
        );

        var rounds = data.dimension(function (d) {
            return d["economy"];
        });
        var statsByRounds = rounds.group().reduce(
                function (p, v) {
                    p.amountRaised += +v["score_patente"];
                    p.deals += +v["rank_patente"];
                    return p;
                },
                function (p, v) {
                    p.amountRaised -= +v["score_patente"];
                    p.deals -= +v["rank_patente"];
                    return p;
                },
                function () {
                    return {amountRaised: 0, deals: 0}
                }
        );

		var widthcomp =  document.getElementById('correlatos').offsetWidth;		
		
        
		d3.json(world_countries, function (statesJson) {
            usChart.width(widthcomp-20)
                    .height(widthcomp/2)
                    .dimension(states)
                    .group(rankGlobalSum)                    
					  .colors(["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704","#ccc"])
                    .colorDomain([1, 100])
					.projection(d3.geo.mercator()
						.translate([widthcomp*.475, 350])
						.rotate([0,0])
						.scale(widthcomp*.175))
                    .overlayGeoJson(statesJson.features, "state", function (d) {
                        return d.properties.name;
                    })
                    .title(function (d) {
                        return "Pais: " + d.key + "\nRanking: " + numberFormat(d.value) ;
                    });

            industryChart.width(widthcomp/2)
                    .height(widthcomp/2)
                    .margins({top: 10, right: 50, bottom: 30, left: 60})
                    .dimension(industries)
                    .group(statsByIndustries)
                    .colors(d3.scale.category10())
                    .keyAccessor(function (p) {
                        return p.value.amountRaised;
                    })
                    .valueAccessor(function (p) {
                        return p.value.deals;
                    })
                    .radiusValueAccessor(function (p) {
                        return p.value.amountRaised;
                    })
                    .x(d3.scale.linear().domain([0, 30]))
                    .r(d3.scale.linear().domain([0, 30]))
                    .minRadiusWithLabel(0)
                    .elasticY(true)
                    .yAxisPadding(10)
                    .elasticX(true)
                    .xAxisPadding(10)
                    .maxBubbleRelativeSize(0.025)
                    .renderHorizontalGridLines(true)
                    .renderVerticalGridLines(true)
                    .renderLabel(true)
                    .renderTitle(true)
                    .title(function (p) {
                        return p.key
                                + "\n"
                                + "Score: " + numberFormat(p.value.amountRaised)
                                + "Posicao: " + numberFormat(p.value.deals);
                    });
            industryChart.yAxis().tickFormat(function (s) {
                return s + " ¬∫";
            });
            industryChart.xAxis().tickFormat(function (s) {
                return s + " pts";
            });

            roundChart.width(widthcomp/2)
                    .height(widthcomp/2)
                    .margins({top: 10, right: 50, bottom: 30, left: 60})
                    .dimension(rounds)
                    .group(statsByRounds)
                    .colors(d3.scale.category10())
                    .keyAccessor(function (p) {
                        return p.value.amountRaised;
                    })
                    .valueAccessor(function (p) {
                        return p.value.deals;
                    })
                    .radiusValueAccessor(function (p) {
                        return p.value.amountRaised;
                    })
                    .x(d3.scale.linear().domain([0, 30]))
                    .r(d3.scale.linear().domain([0, 30]))
                    .minRadiusWithLabel(0)
                    .elasticY(true)
                    .yAxisPadding(10)
                    .elasticX(true)
                    .xAxisPadding(10)
                    .maxBubbleRelativeSize(0.025)
                    .renderHorizontalGridLines(true)
                    .renderVerticalGridLines(true)
                    .renderLabel(true)
                    .renderTitle(true)
                    .title(function (p) {
                        return p.key
                                + "\n"
                                + "Score: " + numberFormat(p.value.amountRaised)
                                + "Posicao: " + numberFormat(p.value.deals);
                    });
            roundChart.yAxis().tickFormat(function (s) {
                return s + " ¬∫";
            });
            roundChart.xAxis().tickFormat(function (s) {
                return s + " pts";
            });

            dc.renderAll();
        });
    });
	
	
	var widthcomp =  document.getElementById('mapa2').offsetWidth;
	//var treemapHeight =  document.getElementById('treemap').offsetHeight;
	
	var margin = {top: 20, right: 0, bottom: 0, left: 0},
		treemapHeight =  (500 ) + (document.getElementById('treemap').offsetHeight);
	
	var text_string = "Uma fibra √≥ptica feita inteiramente de hidrogel - um material el√°stico, parecido com uma borracha, e composto quase inteiramente por √°gua - dever√° se tornar o instrumento preferido em uma s√©rie de tecnologias m√©dicas. As fibras √≥pticas j√° s√£o largamente utilizadas em medicina, de exames e cirurgias, at√© as mais explorat√≥rias t√©cnicas optogen√©ticas, usadas, entre outras coisas, para controlar o c√©rebro com luz.   Mas o c√©rebro √© mais parecido com uma gelatina, enquanto as fibras √≥pticas comuns s√£o como vidro, muito r√≠gidas, podendo danificar os tecidos cerebrais. [Com fibras] que atinjam a flexibilidade e a maciez do c√©rebro, poderemos oferecer estimula√ß√£o e terapias mais eficazes a longo prazo, disse o professor Xuanhe Zhao, do MIT, nos EUA. Fibra √≥ptica de hidrogel A fibra √≥ptica de hidrogel √© formada por um material central encapsulado por uma camada de prote√ß√£o. O grande feito da equipe foi ajustar a composi√ß√£o dos dois materiais para que eles tivessem √≠ndices de refra√ß√£o bem distintos, o que √© essencial para transmitir o m√°ximo poss√≠vel de luz - com √≠ndices similares, a luz que entra pelo n√∫cleo simplesmente vaza pela prote√ß√£o externa. Inserindo corantes ao longo da fibra, √© poss√≠vel detectar exatamente onde a fibra se dobra, o que √© importante para a inser√ß√£o do dispositivo no corpo humano, para monitorar os movimentos de pr√≥teses e implantes ou para acompanhar a recupera√ß√£o de membros, afirmam os pesquisadores Uma microc√¢mera mais fina do que um fio de cabelo humano pode n√£o apenas facilitar os exames m√©dicos atuais, como tamb√©m criar uma nova gera√ß√£o de exames mais precisos e menos invasivos. Timo Gissibl e seus colegas da Universidade de Stuttgart, na Alemanha, usaram uma t√©cnica especial de microimpress√£o 3D - ou manufatura aditiva - para criar uma c√¢mera totalmente funcional que n√£o √© maior do que um gr√£o de sal. A t√©cnica, que poder√° ser aplicada a outros tipos de componentes √≥pticos, usa um laser para atingir pontos espec√≠ficos de um pol√≠mero, construindo o sistema de lentes da microc√¢mera camada por camada. Como a microc√¢mera pode ser constru√≠da na ponta de uma fibra √≥ptica, passa a ser poss√≠vel criar uma nova gera√ß√£o de endosc√≥pios ultrafinos.  grande vantagem da t√©cnica √© que ela permite a constru√ß√£o de sistemas com m√∫ltiplas lentes ou lentes com formatos especializados e mais pr√≥ximos do ideal para cada aplica√ß√£o, como paraboloides ou lentes asf√©ricas - lentes cujo perfil n√£o √© uma parte de uma esfera ou cilindro. Em particular, sistemas √≥pticos com duas ou mais lentes podem ser constru√≠dos pela primeira vez com este m√©todo. Isto abre a porta para sistemas de corre√ß√£o de aberra√ß√£o e de imagens micro-√≥pticas com uma qualidade sem precedentes, dizem os pesquisadores.  c√¢mera inteira tem apenas 125 micr√¥metros de di√¢metro, podendo focar objetos a uma dist√¢ncia de at√© 3 mil√≠metros. Os dados s√£o enviados por uma fibra √≥ptica de 1,7 metro de comprimento. Com essas dimens√µes, ela passa com folga pelo buraco de uma agulha de seringa, podendo gerar imagens de qualquer √≥rg√£o do corpo humano - incluindo o c√©rebro. Al√©m dos exames m√©dicos, Gissibl afirma que a tecnologia poder√° ser usada em sistemas de c√¢meras de seguran√ßa invis√≠veis aos usu√°rios e em mini e microrrob√¥s. Uma cadeira de rodas que pode ser controlada por pequenos movimentos da face, da cabe√ßa ou da √≠ris foi desenvolvida por engenheiros eletricistas e de computa√ß√£o da Unicamp (Universidade Estadual de Campinas). A equipe j√° iniciou um projeto junto √† FAPESP (Funda√ß√£o de Amparo √† Pesquisa do Estado de S√£o Paulo) para tornar a tecnologia acess√≠vel e coloc√°-la no mercado em um prazo estimado em dois anos. Nosso objetivo √© que o produto final custe no m√°ximo o dobro de uma cadeira motorizada comum, dessas que s√£o controladas por joystick e hoje custam em torno de R$ 7 mil, disse o professor Eleri Cardozo. A tecnologia dever√° beneficiar pessoas com tetraplegia, v√≠timas de acidente vascular cerebral (AVC), portadores de esclerose lateral amiotr√≥fica ou outras condi√ß√µes de sa√∫de que impedem o movimento preciso das m√£os. Juntando tecnologias O n√∫cleo da automa√ß√£o da cadeira de rodas est√° em uma c√¢mera 3D com a tecnologia RealSense, da Intel, que permite interagir com o computador por meio de express√µes faciais ou movimentos corporais. O processamento √© feito por um notebook. A c√¢mera identifica mais de 70 pontos da face - em torno da boca, do nariz e dos olhos - e, a partir da movimenta√ß√£o desses pontos, √© poss√≠vel extrair comandos simples, como ir para frente, para tr√°s, para a esquerda ou direita e, o mais importante, parar, explicou Cardozo. Pensando em pacientes com quadros ainda mais graves - que impedem at√© mesmo a movimenta√ß√£o facial - o grupo tamb√©m trabalha em uma tecnologia de interface c√©rebro-computador que permite extrair sinais diretamente do c√©rebro, por meio de eletrodos externos, e transform√°-los em comandos. O equipamento, no entanto, ainda n√£o est√° embarcado na cadeira robotizada. A cadeira tamb√©m foi equipada como uma antena wifi que permite a um cuidador dirigir o equipamento remotamente, pela internet. Essas interfaces exigem do usu√°rio um n√≠vel de concentra√ß√£o que pode ser cansativo. Por isso, se houver necessidade, a qualquer momento outra pessoa pode assumir o comando da cadeira, contou Cardozo. Melhorando a automa√ß√£o O pesquisador Paulo Gurgel Pinheiro, por sua vez, pretende simplificar o sistema para que ele possa ser usado em qualquer cadeira de rodas motorizada e controlada por joystick. Para isso, ele pretende desenvolver um software e uma minigarra mec√¢nica que ser√° respons√°vel por traduzir os comandos do software de leitura facial e controlar o joystick. Nossa ideia √© que o usu√°rio possa baixar o software que far√° o processamento das express√µes faciais em seu notebook. O computador ficar√° conectado a essa minigarra por meio de uma porta USB. Quando ele fizer as express√µes-chave, como um beijo, um meio sorriso, franzir o nariz, inflar as bochechas ou levantar as sobrancelhas, o software manda o comando para a garra e essa movimenta o joystick. Dessa forma, n√£o mexemos na estrutura da cadeira e ela n√£o perde a garantia, explicou Pinheiro. O pesquisador estima que um prot√≥tipo do sistema, j√° batizado de Wheelie, estar√° pronto at√© o in√≠cio de 2017. M√∫sculo artificial pneum√°tico Engenheiros japoneses criaram um novo tipo de exoesqueleto que d√° suporte ao andar sem a necessidade de quaisquer dispositivos eletr√¥nicos ou baterias.  equipamento, chamado UPS (Unplugged Powered Suit) funciona com base em um novo tipo de m√∫sculo artificial pneum√°tico, chamado PGM (Pneumatic Gel Muscle). O exoesqueleto pode melhorar a qualidade de vida n√£o apenas dos idosos e pacientes debilitados, mas tamb√©m de pessoas saud√°veis que gostam de atividades esportivas, que podem obter um impulso extra para aumentar a velocidade de suas corridas.Sem baterias O aparelho consiste em tr√™s partes: o atuador (m√∫sculo artificial), um compressor de ar para acionar o m√∫sculo artificial e os tubos de transmiss√£o. Como a press√£o do ar √© baixa, o aparelho final ficou leve e flex√≠vel, sendo f√°cil de usar, sem provocar desconforto. A bomba de ar √© acionada ao pisar, de forma que o pr√≥prio movimento da pessoa fornece a energia de atua√ß√£o, dispensando as mais tradicionais baterias. O exoesqueleto cobre a articula√ß√£o do quadril e a bomba √© acionada na contralateral. Este arranjo permite apoiar o movimento da coxa na fase de balan√ßo, explica o professor Yuichi Kurita, da Universidade de Hiroshima. Suporte ao movimento humano Segundo Kurita, h√° duas aplica√ß√µes principais para o exoesqueleto, uma voltada para diminuir a atividade muscular durante a corrida e outra para aumentar a velocidade do andar ou correr. Numa e noutra fun√ß√£o, as duas partes superiores do exoesqueleto devem ser reposicionadas conforme o m√∫sculo sobre o qual o aparelho deve agir. S√≥ a bomba fica no calcanhar do p√© do lado oposto ao m√∫sculo artificial - ou nos dois, em uma configura√ß√£o completa. O exoesqueleto foi projetado para dar suporte ao movimento humano onde e quando necess√°rio. Ele n√£o cont√©m quaisquer dispositivos pesados. Isso significa que n√≥s podemos personalizar o exoesqueleto para necessidades espec√≠ficas do usu√°rio, tais como for√ßa muscular para atletas ou para reabilita√ß√£o. No futuro, n√≥s poderemos desenvolver roupas assistivas mais inteligentes, incluindo atuadores e sensores de vestir usando nossa t√©cnica, disse o professor Kurita. Embora ainda sem data marcada, h√° expectativas de que o exoesqueleto possa chegar ao mercado, uma vez que a pesquisa est√° sendo feita em parceria com a empresa Daiya Industry, que construiu o prot√≥tipo. Pequenos rob√¥s capazes de entrar no corpo humano e curar doen√ßas ainda est√£o distantes da realidade. Mas a chance de voc√™ engolir uma c√°psula rob√≥tica em um futuro pr√≥ximo agora aumentou dramaticamente. Engenheiros da Universidade de Vanderbilt, nos EUA, lan√ßaram em sistema de c√≥digo aberto (open-source) o projeto - hardware e software - de uma p√≠lula rob√≥tica. O objetivo √© que equipes de pesquisa de todo o mundo n√£o precisem mais come√ßar do zero, concentrando esfor√ßos na funcionalidade das p√≠lulas rob√≥ticas para aplica√ß√µes espec√≠ficas em sa√∫de. P√≠lula open-source Os m√≥dulos de hardware lidam com a computa√ß√£o, comunica√ß√£o sem fio, alimenta√ß√£o, detec√ß√£o e atua√ß√£o. Cada m√≥dulo foi projetado para ser facilmente interfaceado com tecnologias em desenvolvimento por outros grupos de pesquisa. No lado do software, a equipe usa o TinyOS, sistema operacional livre, para desenvolver rotinas reutiliz√°veis. N√≥s projetamos c√°psulas customizadas - uma para o c√≥lon, uma para o est√¥mago e outra com um grampo para parar hemorragias - mas vimos que est√°vamos basicamente reutilizando os mesmos componentes, disse o professor Pietro Valdastri. √â como montar blocos de Lego, voc√™ pode remont√°-los para diferentes fun√ß√µes. N√≥s queremos oferecer √†s pessoas trabalhando nesse campo nossos blocos Lego para que elas montem suas pr√≥prias c√°psulas, acrescentou. O kit completo das c√°psulas rob√≥ticas foi disponibilizado na plataforma GitHub.  ";

      drawWordCloud(text_string);

      function drawWordCloud(text_string){
        var common = "a ,√†,agora,ainda,algu√©m,algum,alguma,duas,r$,mil, tornar,algumas,alguns,ampla,amplas,dois,qualquer,onde, poderemos, podem,70,√†s, d√°,cujo,amplo,amplos,ante,antes,ao,aos,ap√≥s,aquela,aquelas,aquele,aqueles,aquilo,as,at√©,mais,atrav√©s,cada,coisa,coisas,com,como,contra,contudo,da,daquele,daqueles,das,de,dela,delas,dele,deles,depois,dessa,dessas,desse,desses,desta,destas,deste,deste,destes,deve,devem,devendo,dever,dever√°,dever√£o,deveria,deveriam,devia,deviam,disse,disso,disto,dito,diz,dizem,do,dos,e,√©,e',ela,elas,ele,eles,em,enquanto,entre,era,essa,essas,esse,esses,esta,est√°,estamos,est√£o,estas,estava,estavam,est√°vamos,este,estes,estou,eu,fazendo,fazer,feita,feitas,feito,feitos,foi,for,foram,fosse,fossem,grande,grandes,h√°,isso,isto,j√°,la,la,l√°,lhe,lhes,lo,mas,me,mesma,mesmas,mesmo,mesmos,meu,meus,minha,minhas,muita,muitas,muito,muitos,na,n√£o,nas,nem,nenhum,nessa,nessas,nesta,nestas,ningu√©m,no,nos,n√≥s,nossa,nossas,nosso,nossos,num,numa,nunca,o,os,ou,outra,outras,outro,outros,para,pela,pelas,pelo,pelos,pequena,pequenas,pequeno,pequenos,per,perante,pode,p√¥de,podendo,poder,poderia,poderiam,podia,podiam,pois,por,por√©m,porque,posso,pouca,poucas,pouco,poucos,primeiro,primeiros,pr√≥pria,pr√≥prias,pr√≥prio,pr√≥prios,quais,qual,quando,quanto,quantos,que,quem,s√£o,se,seja,sejam,sem,sempre,sendo,ser√°,ser√£o,seu,seus,si,sido,s√≥,sob,sobre,sua,suas,talvez,tamb√©m,tampouco,te,tem,tendo,tenha,ter,teu,teus,ti,tido,tinha,tinham,toda,todas,todavia,todo,todos,tu,tua,tuas,tudo,√∫ltima,√∫ltimas,√∫ltimo,√∫ltimos,um,uma,umas,uns,vendo,ver,vez,vindo,vir,vos,v√≥s,";

        var word_count = {};

        var words = text_string.split(/[ '\-\(\)\*":;\[\]|{},.!?]+/);
          if (words.length == 1){
            word_count[words[0]] = 1;
          } else {
            words.forEach(function(word){
              var word = word.toLowerCase();
              if (word != "" && common.indexOf(word)==-1 && word.length>1){
                if (word_count[word]){
                  word_count[word]++;
                } else {
                  word_count[word] = 1;
                }
              }
            })
          }

        var svg_location = "#chart-01";
        var width = widthcomp;
		//console.log(treemapHeight);
        var height = treemapHeight;
		//console.log(height);
        var fill = d3.scale.category20();

        var word_entries = d3.entries(word_count);

        var xScale = d3.scale.linear()
           .domain([0, d3.max(word_entries, function(d) {
              return d.value;
            })
           ])
           .range([10,100]);

        d3.layout.cloud().size([width, height])
          .timeInterval(20)
          .words(word_entries)
          .fontSize(function(d) { return xScale(+d.value); })
          .text(function(d) { return d.key; })
          .rotate(function() { return ~~(Math.random() * 2) * 90; })
          .font("Impact")
          .on("end", draw)
          .start();

        function draw(words) {
          d3.select(svg_location).append("svg")
              .attr("width", width)
              .attr("height", height)
            .append("g")
              .attr("transform", "translate(" + [width >> 1, height >> 1] + ")")
            .selectAll("text")
              .data(words)
            .enter().append("text")
              .style("font-size", function(d) { return xScale(d.value) + "px"; })
              .style("font-family", "Impact")
              .style("fill", function(d, i) { return fill(i); })
              .attr("text-anchor", "middle")
              .attr("transform", function(d) {
                return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
              })
              .text(function(d) { return d.key; });
        }

        d3.layout.cloud().stop();
      }
	  
  